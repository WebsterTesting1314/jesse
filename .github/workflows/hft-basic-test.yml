name: HFT Basic Test - HFT ç³»çµ±åŸºç¤Žæ¸¬è©¦

on:
  push:
    branches: [ master, develop ]
  pull_request:
    branches: [ master, develop ]
  workflow_dispatch:

jobs:
  basic-check:
    name: ðŸ” åŸºç¤Žæª¢æŸ¥
    runs-on: ubuntu-latest
    
    steps:
      - name: ðŸ“¥ å–å¾—ä»£ç¢¼
        uses: actions/checkout@v4
      
      - name: ðŸ è¨­ç½® Python ç’°å¢ƒ
        uses: actions/setup-python@v4
        with:
          python-version: '3.12'
      
      - name: ðŸ“Š æª¢æŸ¥ HFT ç³»çµ±æª”æ¡ˆ
        run: |
          echo "ðŸ” æª¢æŸ¥ HFT ç³»çµ±æª”æ¡ˆ..."
          
          # åˆ—å‡º HFT ç›¸é—œæª”æ¡ˆ
          echo "ðŸ“‚ HFT æœå‹™æª”æ¡ˆ:"
          find core/jesse/services -name "hft_*.py" -type f | head -10
          
          echo "ðŸ“‚ HFT æŒ‡æ¨™æª”æ¡ˆ:"
          find core/jesse/indicators -name "hft_*.py" -type f | head -5
          
          echo "ðŸ“‚ HFT å„²å­˜æª”æ¡ˆ:"
          find core/jesse/store -name "hft_*.py" -type f | head -5
          
          echo "ðŸ“‚ HFT æ¸¬è©¦æª”æ¡ˆ:"
          find core/tests -name "test_hft_*.py" -type f | head -5
          
          # æª¢æŸ¥å·¥ä½œæµç¨‹æª”æ¡ˆ
          echo "âš™ï¸ CI/CD å·¥ä½œæµç¨‹æª”æ¡ˆ:"
          ls -la .github/workflows/
          
          echo "âœ… HFT ç³»çµ±æª”æ¡ˆæª¢æŸ¥å®Œæˆ"
      
      - name: ðŸ§® èªžæ³•æª¢æŸ¥
        run: |
          echo "ðŸ” æª¢æŸ¥ Python èªžæ³•..."
          
          # å®‰è£åŸºæœ¬å·¥å…·
          pip install --upgrade pip
          
          # æª¢æŸ¥ HFT æœå‹™æª”æ¡ˆèªžæ³•
          echo "ðŸ“‹ æª¢æŸ¥ HFT æœå‹™æª”æ¡ˆèªžæ³•:"
          for file in core/jesse/services/hft_*.py; do
            if [ -f "$file" ]; then
              echo "  æª¢æŸ¥: $file"
              python -m py_compile "$file"
            fi
          done
          
          echo "âœ… èªžæ³•æª¢æŸ¥å®Œæˆ"
      
      - name: ðŸ“Š ç”ŸæˆåŸºç¤Žå ±å‘Š
        run: |
          echo "ðŸ“ ç”Ÿæˆ HFT ç³»çµ±åŸºç¤Žæª¢æŸ¥å ±å‘Š..."
          
          cat > hft_basic_report.md << 'EOF'
          # ðŸš€ HFT ç³»çµ±åŸºç¤Žæª¢æŸ¥å ±å‘Š
          
          ## ðŸ“… åŸ·è¡Œæ™‚é–“
          **åŸ·è¡Œæ™‚é–“:** $(date)
          **æäº¤é›œæ¹Š:** ${{ github.sha }}
          **åˆ†æ”¯:** ${{ github.ref_name }}
          
          ## âœ… æª¢æŸ¥çµæžœ
          - âœ… ä»£ç¢¼å–å¾—æˆåŠŸ
          - âœ… Python ç’°å¢ƒè¨­ç½®å®Œæˆ
          - âœ… HFT ç³»çµ±æª”æ¡ˆå­˜åœ¨
          - âœ… Python èªžæ³•æª¢æŸ¥é€šéŽ
          
          ## ðŸ“Š çµ±è¨ˆä¿¡æ¯
          EOF
          
          # æ·»åŠ çµ±è¨ˆä¿¡æ¯
          hft_services=$(find core/jesse/services -name "hft_*.py" -type f | wc -l)
          echo "- HFT æœå‹™æª”æ¡ˆæ•¸é‡: $hft_services" >> hft_basic_report.md
          
          hft_indicators=$(find core/jesse/indicators -name "hft_*.py" -type f | wc -l)
          echo "- HFT æŒ‡æ¨™æª”æ¡ˆæ•¸é‡: $hft_indicators" >> hft_basic_report.md
          
          hft_tests=$(find core/tests -name "test_hft_*.py" -type f | wc -l)
          echo "- HFT æ¸¬è©¦æª”æ¡ˆæ•¸é‡: $hft_tests" >> hft_basic_report.md
          
          echo "" >> hft_basic_report.md
          echo "## ðŸŽ¯ ä¸‹ä¸€æ­¥è¨ˆåŠƒ" >> hft_basic_report.md
          echo "- ðŸ“Š åŸ·è¡Œå–®å…ƒæ¸¬è©¦" >> hft_basic_report.md
          echo "- ðŸ”§ åŸ·è¡Œé›†æˆæ¸¬è©¦" >> hft_basic_report.md
          echo "- âš¡ åŸ·è¡Œæ€§èƒ½æ¸¬è©¦" >> hft_basic_report.md
          echo "- ðŸš€ æº–å‚™éƒ¨ç½²" >> hft_basic_report.md
          
          echo "" >> hft_basic_report.md
          echo "*æ­¤å ±å‘Šç”± GitHub Actions è‡ªå‹•ç”Ÿæˆ*" >> hft_basic_report.md
          
          echo "ðŸ“‹ åŸºç¤Žæª¢æŸ¥å ±å‘Š:"
          cat hft_basic_report.md
      
      - name: ðŸ“¤ ä¸Šå‚³å ±å‘Š
        uses: actions/upload-artifact@v3
        with:
          name: hft-basic-report
          path: hft_basic_report.md
          retention-days: 30